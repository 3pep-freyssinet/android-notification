<!DOCTYPE html>
<html>
<head>
  <script type="text/javascript">
    let turnstileIsReady = false;
    let turnstileWidgetId = null;

    function onCaptchaSuccess(token) {
      console.log("Success:", token);
      if (window.HCaptchaInterface?.onCaptchaSuccess)
        HCaptchaInterface.onCaptchaSuccess(token);
    }

    function onCaptchaError() {
      console.log("Error");
      if (window.HCaptchaInterface?.onCaptchaError)
        HCaptchaInterface.onCaptchaError();
    }

    function onTurnstileLoaded() {
      turnstileIsReady = true;
      const container = document.getElementById('cf-turnstile');
      if (container) {
        turnstileWidgetId = turnstile.getWidgetId(container);
        console.log("Widget ID:", turnstileWidgetId);
      }

      if (window.HCaptchaInterface?.onTurnstileReady)
        HCaptchaInterface.onTurnstileReady();
    }

    function resetTurnstileWidget() {
      if (turnstileIsReady && turnstileWidgetId !== null) {
        console.log("Resetting Turnstile widget");
        turnstile.reset(turnstileWidgetId);
      } else {
        console.warn("Turnstile not ready or no widget ID");
      }
    }
  </script>

  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onTurnstileLoaded" async defer></script>
</head>

  <body>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onTurnstileLoaded" async defer></script>
    <div id="cf-turnstile" class="cf-turnstile"
           data-sitekey="CLOUDFLARE_SITE_KEY"
           data-callback="onCaptchaSuccess"
           data-error-callback="onCaptchaError">
      </div>
  </body>
</html>
