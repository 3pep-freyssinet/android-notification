<!DOCTYPE html>
<html>
  <head>
    <title>Cloudflare Turnstile Demo</title>

    <!-- Cloudflare Turnstile JS -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onTurnstileLoaded" async defer></script>

    <script type="text/javascript">
      let turnstileIsReady = false;
      let widgetId = null;

      function onCaptchaSuccess(token) {
        if (window.HCaptchaInterface && HCaptchaInterface.onCaptchaSuccess) {
          HCaptchaInterface.onCaptchaSuccess(token);
        }
      }

      function onCaptchaError() {
        if (window.HCaptchaInterface && HCaptchaInterface.onCaptchaError) {
          HCaptchaInterface.onCaptchaError();
        }
      }

      function onTurnstileLoaded() {
        turnstileIsReady = true;
        console.log("Turnstile loaded.");

        try {
          widgetId = turnstile.render('#cf-turnstile', {
            sitekey: 'CLOUDFLARE_SITE_KEYY', // Replace with your actual site key
            callback: onCaptchaSuccess,
            'error-callback': onCaptchaError
          });

          if (window.HCaptchaInterface && HCaptchaInterface.onTurnstileReady) {
            HCaptchaInterface.onTurnstileReady();
          }
        } catch (e) {
          console.error("Turnstile render failed:", e);
        }
      }

      function resetCaptcha() {
        if (turnstileIsReady && widgetId !== null) {
          turnstile.reset(widgetId);
        } else {
          console.warn("Turnstile not ready or widgetId missing");
        }
      }
    </script>
  </head>

  <body>
    <form>
      <div id="cf-turnstile" class="cf-turnstile"></div>
    </form>
  </body>
</html>
